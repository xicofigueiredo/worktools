<% year_now = Date.current.year %>

<% total_holidays = @current_entitlement_total || 25 %>
<% holidays_left = @current_entitlement_left || 25 %>
<% mandatory_count = @current_mandatory_count || 0 %>
<% voluntary_booked = @current_voluntary_booked || 0 %>
<% pending_holiday = @current_pending_holiday || 0 %>
<% booked_carry_over = @current_booked_carry || 0 %>
<% pending_carry_over = @current_pending_carry || 0 %>
<% next_year = year_now + 1 %>

<div class="card mb-4">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">My Leave for <%= year_now %></h5>
    <div>
      <%= link_to 'New Leave Request', new_leafe_path, class: 'btn btn-primary' %>
    </div>
  </div>

  <div class="card-body p-0">
    <table class="table mb-0">
      <thead class="table-light">
        <tr>
          <th>Type</th>
          <th>Total Allowance</th>
          <th>Mandatory</th>
          <th>Booked (Voluntary)</th>
          <th>Pending</th>
          <th>Left</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Holidays</td>
          <td><%= total_holidays %></td>

          <td><%= mandatory_count %></td>

          <td>
            <%= voluntary_booked %>
            <% if booked_carry_over > 0 %>
              <small class="text-muted">(<%= booked_carry_over %> in <%= next_year %>)</small>
            <% end %>
          </td>

          <td>
            <%= pending_holiday %>
            <% if pending_carry_over > 0 %>
              <small class="text-muted">(<%= pending_carry_over %> in <%= next_year %>)</small>
            <% end %>
          </td>

          <td><%= holidays_left %></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
