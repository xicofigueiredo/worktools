<div class="container-fluid" style="height: 100vh; overflow: hidden;">
  <div class="row" style="height: 100vh;">
    <!-- Sidebar for chat history -->
    <div class="col-md-3 bg-light border-end d-flex flex-column" style="height: 100vh;">
      <div class="p-3 border-bottom">
        <h5 class="mb-3">AI Tutor Chat</h5>

        <!-- Subject Selection -->
        <%= form_with url: chats_path, method: :post, local: true, class: "mb-3" do |form| %>
          <div class="mb-2">
            <%= form.select :subject_id,
                options_from_collection_for_select(@subjects, :id, :name),
                { prompt: "Select a subject to start chatting..." },
                { class: "form-select", onchange: "this.form.submit();" } %>
          </div>
        <% end %>
      </div>

      <!-- User's Chat History -->
      <div class="flex-grow-1 overflow-auto">
        <div class="p-3">
          <h6 class="text-muted mb-3">Recent Chats</h6>
          <% if @chats.any? %>
            <% @chats.each do |chat| %>
              <div class="card mb-2">
                <div class="card-body p-2">
                  <%= link_to chat, class: "text-decoration-none" do %>
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <h6 class="card-title mb-1 text-truncate">
                          <i class="fas fa-graduation-cap me-1"></i>
                          <%= chat.subject.name %>
                        </h6>
                        <small class="text-muted">
                          <%= pluralize(chat.chat_messages.count, 'message') %>
                        </small>
                      </div>
                      <small class="text-muted">
                        <%= time_ago_in_words(chat.updated_at) %> ago
                      </small>
                    </div>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% else %>
            <div class="text-center text-muted my-4">
              <i class="fas fa-comments fa-2x mb-3"></i>
              <p>No chats yet.<br>Select a subject to start!</p>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Main welcome area -->
    <div class="col-md-9 d-flex flex-column justify-content-center align-items-center" style="height: 100vh;">
      <div class="text-center">
        <div class="mb-4">
          <i class="fas fa-robot fa-5x text-primary mb-4"></i>
          <h1 class="display-4 mb-3">Welcome to AI Tutor</h1>
          <p class="lead text-muted mb-4">
            Your personalized learning assistant powered by AI
          </p>
        </div>

        <div class="row justify-content-center">
          <div class="col-md-8">
            <div class="card shadow-sm border-0">
              <div class="card-body p-4">
                <h5 class="card-title mb-3">
                  <i class="fas fa-graduation-cap me-2 text-primary"></i>
                  Getting Started
                </h5>
                <div class="row text-start">
                  <div class="col-md-6">
                    <h6><i class="fas fa-book me-2 text-success"></i>Choose Your Subject</h6>
                    <p class="small text-muted">Select any subject from the dropdown to begin your personalized learning session.</p>
                  </div>
                  <div class="col-md-6">
                    <h6><i class="fas fa-comments me-2 text-info"></i>Ask Questions</h6>
                    <p class="small text-muted">Get instant help with homework, explanations, and study guidance tailored to your level.</p>
                  </div>
                </div>
                <div class="row text-start">
                  <div class="col-md-6">
                    <h6><i class="fas fa-brain me-2 text-warning"></i>Personalized Learning</h6>
                    <p class="small text-muted">The AI adapts to your learning style, progress, and individual needs.</p>
                  </div>
                  <div class="col-md-6">
                    <h6><i class="fas fa-history me-2 text-secondary"></i>Chat History</h6>
                    <p class="small text-muted">All your conversations are saved so you can review them anytime.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <% if @current_chat %>
          <div class="mt-4">
            <%= link_to @current_chat, class: "btn btn-primary btn-lg" do %>
              <i class="fas fa-arrow-right me-2"></i>Continue Last Chat
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
